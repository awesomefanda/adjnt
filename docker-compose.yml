services:
  # WhatsApp Engine
  waha:
    image: devlikeapro/waha
    container_name: waha
    restart: unless-stopped
    ports:
      - "3001:3000"
    environment:
      - WAHA_SECURITY_MODE=DISABLED
      - WAHA_NO_API_KEY=True
      - WHATSAPP_DEFAULT_ENGINE=NOWEB
      # ðŸš€ Use the SERVICE NAME 'adjnt'
      - WHATSAPP_HOOK_URL=http://adjnt:8000/webhook
      - WHATSAPP_HOOK_EVENTS=message,message.any
    volumes:
      - ./waha_sessions:/app/.sessions

  # AI Assistant
  adjnt:
    build: .
    # ðŸš€ Changed to match the service name for clarity
    container_name: adjnt
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      - WAHA_URL=http://waha:3000
      - PYTHONUNBUFFERED=1
      # ðŸš€ These will be pulled by your new Groq brain.py
      - GROQ_API_KEY=${GROQ_API_KEY}
      - MODEL_NAME=${MODEL_NAME}
    volumes:
      - .:/app
    depends_on:
      - waha